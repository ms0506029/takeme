<!DOCTYPE html>
<html>
<head>

  <meta charset="UTF-8">
  <title>æ¸¬è©¦é é¢</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 40px;
      background: #f5f5f5;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 10px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .btn {
      padding: 10px 20px;
      background: #4A90E2;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>âœ… æ¸¬è©¦é é¢è¼‰å…¥æˆåŠŸï¼</h1>
    <p>å¦‚æœæ‚¨èƒ½çœ‹åˆ°é€™å€‹é é¢ï¼Œè¡¨ç¤º Web App éƒ¨ç½²æ­£å¸¸ã€‚</p>
    <p>ç•¶å‰æ™‚é–“ï¼š<span id="time"></span></p>
    
    <h2>è¨ºæ–·è³‡è¨Š</h2>
    <ul>
      <li>âœ… HTML æª”æ¡ˆå¯ä»¥æ­£å¸¸è¼‰å…¥</li>
      <li>âœ… JavaScript å¯ä»¥æ­£å¸¸åŸ·è¡Œ</li>
      <li>âœ… CSS æ¨£å¼å¯ä»¥æ­£å¸¸å¥—ç”¨</li>
    </ul>
    
    <a href="<?= appUrl ?>" class="btn" target="_top">â† å›ä¸»é¸å–®</a>
    <button class="btn" onclick="testAPI()">æ¸¬è©¦ API é€£ç·š</button>
    
    <div id="result" style="margin-top: 20px;"></div>
  </div>
  
  <script>
    // é¡¯ç¤ºæ™‚é–“
    document.getElementById('time').textContent = new Date().toLocaleString('zh-TW');
    
    // å›ä¸»é¸å–®
    function goHome() {
      window.top.location.href = window.location.href.split('?')[0];
    }
    
    // æ¸¬è©¦ API
    function testAPI() {
      document.getElementById('result').innerHTML = 'ğŸ”„ æ¸¬è©¦ä¸­...';
      
      google.script.run
        .withSuccessHandler(function(result) {
          document.getElementById('result').innerHTML = `
            <h3 style="color: green;">âœ… API é€£ç·šæˆåŠŸï¼</h3>
            <p>è¿”å›çµæœï¼š${JSON.stringify(result)}</p>
          `;
        })
        .withFailureHandler(function(error) {
          document.getElementById('result').innerHTML = `
            <h3 style="color: red;">âŒ API é€£ç·šå¤±æ•—</h3>
            <p>éŒ¯èª¤è¨Šæ¯ï¼š${error.message}</p>
          `;
        })
        .apiGetWebAppUrl();
    }
  </script>
</body>
</html>
